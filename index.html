<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kickcoins - Fantasy Betting</title>
<style>
body { font-family: Arial, sans-serif; background-color: #121212; color: #fff; margin:0; padding:0; }
header { display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background-color:#1a1a1a; }
header .account { display:flex; align-items:center; gap:15px; }
header .account img { width:24px; height:24px; }
.tabs { display:flex; background-color:#1a1a1a; }
.tab { flex:1; padding:10px; text-align:center; cursor:pointer; border-bottom:2px solid #121212; }
.tab.active { border-bottom:2px solid #00ff00; }
main { padding:20px; }
.card { background-color:#1f1f1f; padding:15px; margin:10px 0; border-radius:8px; }
.prop { display:flex; justify-content:space-between; align-items:center; margin:10px 0; }
.prop input[type="number"] { width:50px; margin-left:10px; }
select { padding:5px; }
button { padding:5px 10px; cursor:pointer; border:none; border-radius:5px; }
.green { color:#00ff00; }
.yellow { color:#ffff00; }
.orange { color:#ff9900; }
.red { color:#ff0000; }
table { width:100%; border-collapse:collapse; }
th, td { padding:8px; text-align:left; border-bottom:1px solid #333; }
.medal { width:20px; height:20px; vertical-align:middle; margin-right:5px; }
</style>
</head>
<body>

<header>
    <h1>Kickcoins âš½</h1>
    <div class="account" id="account-info"></div>
</header>

<div class="tabs">
    <div class="tab active" data-tab="vote">MVP Voting</div>
    <div class="tab" data-tab="bet">Betting</div>
    <div class="tab" data-tab="leaderboard">Leaderboards</div>
    <div class="tab" data-tab="admin">Admin</div>
</div>

<main>
    <div class="tab-content" id="vote-tab">
        <div class="card">
            <h2>Vote for MVP</h2>
            <label>1st Place:</label>
            <select id="vote1"></select>
            <label>2nd Place:</label>
            <select id="vote2"></select>
            <label>3rd Place:</label>
            <select id="vote3"></select>
            <button id="submit-votes">Submit Votes</button>
        </div>
    </div>

    <div class="tab-content" id="bet-tab" style="display:none;">
        <div class="card">
            <h2>Betting</h2>
            <div id="balance-display"></div>
            <label>Select Player:</label>
            <select id="player-select"></select>
            <div id="props-container"></div>
            <button id="submit-bets">Place Bets</button>
        </div>
    </div>

    <div class="tab-content" id="leaderboard-tab" style="display:none;">
        <div class="card">
            <h2>MVP Leaderboard</h2>
            <table id="mvp-leaderboard">
                <thead><tr><th>Place</th><th>Player</th><th>Points</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="card">
            <h2>Coin Leaderboard</h2>
            <table id="coin-leaderboard">
                <thead><tr><th>Place</th><th>Player</th><th>Coins</th></tr></thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div class="tab-content" id="admin-tab" style="display:none;">
        <div class="card">
            <h2>Admin Controls</h2>
            <button id="start-match">Start Match</button>
            <button id="end-match" disabled>End Match</button>
            <div id="resolve-bets"></div>
        </div>
    </div>
</main>

<script>
const players = ["Erick","Yansy","Bernie","Erubial","Samir","Angel","Abel","Estress","Alan","Ace"];
const propsTemplate = ["Assist","Score","Anything"];
let users = {
    "Erick": { password:"pass", totalCoins:100, availableCoins:0, votes:{}, bets:[], mvpPoints:0 },
    "Yansy": { password:"pass", totalCoins:100, availableCoins:0, votes:{}, bets:[], mvpPoints:0 },
    "admin": { password:"KickCoins123", isAdmin:true }
};
let currentUser = "Erick";
let matchActive = false;

/* ----- TAB NAV ----- */
document.querySelectorAll('.tab').forEach(tab=>{
    tab.addEventListener('click',()=>{
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        tab.classList.add('active');
        document.querySelectorAll('.tab-content').forEach(tc=>tc.style.display='none');
        document.getElementById(tab.dataset.tab+'-tab').style.display='block';
        updateUI();
        if(tab.dataset.tab==="admin") populateResolveBets();
    });
});

/* ----- ACCOUNT DISPLAY ----- */
function updateUI(){
    let acc = users[currentUser];
    let mvpPlace = getLeaderboardPlace("mvpPoints", currentUser);
    let coinPlace = getLeaderboardPlace("totalCoins", currentUser);
    let html = `${currentUser} | Total: ${acc.totalCoins} ðŸ’° (Place ${coinPlace}) | Available: ${acc.availableCoins} ðŸ’¸ | MVP Place: ${mvpPlace}`;
    document.getElementById('account-info').innerHTML = html;
}

/* ----- MVP VOTING ----- */
function populateVoting(){
    ["vote1","vote2","vote3"].forEach(id=>{
        let sel = document.getElementById(id);
        sel.innerHTML = "";
        players.forEach(p=>{
            let opt = document.createElement("option"); opt.value=p; opt.text=p;
            sel.appendChild(opt);
        });
    });
}
document.getElementById('submit-votes').addEventListener('click',()=>{
    users[currentUser].votes = {
        "1st": document.getElementById('vote1').value,
        "2nd": document.getElementById('vote2').value,
        "3rd": document.getElementById('vote3').value
    };
    alert("Votes submitted!");
});

/* ----- BETTING SYSTEM ----- */
function populatePlayers(){
    let sel = document.getElementById('player-select');
    sel.innerHTML="";
    players.forEach(p=>{
        let opt=document.createElement("option"); opt.value=p; opt.text=p;
        sel.appendChild(opt);
    });
    sel.addEventListener('change', populateProps);
}
function populateProps(){
    let container = document.getElementById('props-container');
    container.innerHTML="";
    let player = document.getElementById('player-select').value;
    propsTemplate.forEach(prop=>{
        let card = document.createElement("div"); card.className="prop";
        let label = document.createElement("span"); label.textContent=`${prop} (4x)`; 
        let input = document.createElement("input"); input.type="number"; input.min=0; input.max=users[currentUser].availableCoins;
        input.oninput = function(){ if(this.value>users[currentUser].availableCoins) this.value=users[currentUser].availableCoins; }
        card.appendChild(label); card.appendChild(input);
        container.appendChild(card);
    });
}
document.getElementById('submit-bets').addEventListener('click',()=>{
    let propsDiv = document.getElementById('props-container').children;
    let acc = users[currentUser];
    for(let p of propsDiv){
        let propName = p.querySelector('span').textContent;
        let amt = Number(p.querySelector('input').value);
        if(amt>0){
            if(acc.availableCoins>=amt){
                acc.availableCoins -= amt;
                acc.bets.push({player:document.getElementById('player-select').value,prop:propName,amount:amt,odds:4,resolved:false});
            } else { alert("Cannot bet more than available balance"); }
        }
    }
    updateUI(); alert("Bets placed!");
});

/* ----- ADMIN CONTROLS ----- */
document.getElementById('start-match').addEventListener('click',()=>{
    matchActive = true;
    Object.keys(users).forEach(u=>{
        if(!users[u].isAdmin){
            let acc = users[u];
            let max = Math.min(10, acc.totalCoins);
            acc.availableCoins = max;
            acc.totalCoins -= max;
        }
    });
    updateUI();
    document.getElementById('end-match').disabled = false;
    alert("Match started! Players can now bet.");
});

document.getElementById('end-match').addEventListener('click',()=>{
    if(matchActive){
        let allResolved = true;
        Object.keys(users).forEach(u=>{
            if(!users[u].isAdmin){
                users[u].bets.forEach(b=>{ if(!b.resolved) allResolved=false; });
            }
        });
        if(!allResolved){ alert("Resolve all bets before ending match."); return; }
        matchActive=false;
        Object.keys(users).forEach(u=>{
            if(!users[u].isAdmin) users[u].availableCoins=0;
        });
        updateLeaderboards();
        alert("Match closed. Coins and leaderboards updated!");
    }
});

/* ----- LEADERBOARDS ----- */
function updateLeaderboards(){
    // MVP
    let mvpTable = document.querySelector("#mvp-leaderboard tbody");
    mvpTable.innerHTML="";
    let mvpArr = Object.keys(users).filter(u=>!users[u].isAdmin).sort((a,b)=>users[b].mvpPoints-users[a].mvpPoints);
    mvpArr.forEach((u,i)=>{
        let tr = document.createElement("tr");
        let medal = i==0?"ðŸ¥‡":i==1?"ðŸ¥ˆ":i==2?"ðŸ¥‰":"ðŸªµ";
        tr.innerHTML=`<td>${i+1}</td><td>${medal} ${u}</td><td>${users[u].mvpPoints}</td>`;
        mvpTable.appendChild(tr);
    });
    // Coins
    let coinTable = document.querySelector("#coin-leaderboard tbody");
    coinTable.innerHTML="";
    let coinArr = Object.keys(users).filter(u=>!users[u].isAdmin).sort((a,b)=>users[b].totalCoins-users[a].totalCoins);
    coinArr.forEach((u,i)=>{
        let medal = i==0?"ðŸ¥‡":i==1?"ðŸ¥ˆ":i==2?"ðŸ¥‰":"ðŸªµ";
        let tr = document.createElement("tr");
        tr.innerHTML=`<td>${i+1}</td><td>${medal} ${u}</td><td>${users[u].totalCoins}</td>`;
        coinTable.appendChild(tr);
    });
}

/* ----- ADMIN BET RESOLUTION ----- */
function populateResolveBets(){
    let container = document.getElementById('resolve-bets');
    container.innerHTML="";
    Object.keys(users).forEach(u=>{
        if(!users[u].isAdmin){
            users[u].bets.forEach((b,i)=>{
                if(!b.resolved){
                    let div = document.createElement("div"); div.className="prop";
                    div.innerHTML=`<span>${b.player} - ${b.prop} (${b.amount} coins @${b.odds}x)</span>
                    <button onclick="resolveBet('${u}',${i},true)">Yes</button>
                    <button onclick="resolveBet('${u}',${i},false)">No</button>`;
                    container.appendChild(div);
                }
            });
        }
    });
}
function resolveBet(user,index,won){
    let bet = users[user].bets[index];
    if(won){
        users[user].totalCoins += bet.amount*bet.odds;
    }
    bet.resolved = true;
    populateResolveBets();
    updateUI();
}

/* ----- HELPER ----- */
function getLeaderboardPlace(stat, user){
    let arr = Object.keys(users).filter(u=>!users[u].isAdmin).sort((a,b)=>users[b][stat]-users[a][stat]);
    return arr.indexOf(user)+1;
}

/* ----- INIT ----- */
populateVoting(); populatePlayers(); updateUI();
</script>

</body>
</html>
