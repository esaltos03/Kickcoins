<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Edge Book</title>
  <style>
    body { font-family: Arial, sans-serif; background:#111; color:#eee; margin:0; padding:0; }
    header { background:#000; padding:10px; text-align:center; }
    header h1 { margin:0; color:teal; }
    .hidden { display:none; }
    .container { padding:20px; }
    .tabs button { margin:5px; padding:10px; background:teal; border:none; color:#fff; cursor:pointer; }
    .active { background:#333; }
    input, select { margin:5px; padding:5px; }
    .odds { padding:5px; border-radius:5px; margin:3px; display:inline-block; }
    .green { background:green; }
    .yellow { background:goldenrod; }
    .orange { background:darkorange; }
    .red { background:crimson; }
    #leaderboard, #mvpboard { margin-top:10px; }
  </style>
</head>
<body>
  <header>
    <h1>âš½ Edge Book</h1>
    <div id="userStatus"></div>
  </header>

  <div id="authSection" class="container">
    <h2>Login</h2>
    <input id="loginUser" placeholder="Username"><br>
    <input id="loginPass" type="password" placeholder="Password"><br>
    <button onclick="login()">Login</button>
    <h2>Create Account</h2>
    <input id="newUser" placeholder="Username"><br>
    <input id="newPass" type="password" placeholder="Password"><br>
    <button onclick="createAccount()">Create</button>
  </div>

  <div id="appSection" class="hidden">
    <div class="tabs">
      <button onclick="showTab('betting')">Betting</button>
      <button onclick="showTab('mvp')">MVP Vote</button>
      <button onclick="showTab('leader')">Leaderboards</button>
      <button id="adminTab" class="hidden" onclick="showTab('admin')">Admin</button>
      <button onclick="logout()">Logout</button>
    </div>

    <div id="betting" class="tab hidden container">
      <h2>Betting</h2>
      <div id="betOptions"></div>
      <div id="betPlaced"></div>
    </div>

    <div id="mvp" class="tab hidden container">
      <h2>MVP Voting</h2>
      <select id="mvp1"></select>
      <select id="mvp2"></select>
      <select id="mvp3"></select><br>
      <button onclick="submitMVP()">Submit Vote</button>
      <div id="mvpThanks"></div>
    </div>

    <div id="leader" class="tab hidden container">
      <h2>Coin Leaderboard</h2>
      <div id="leaderboard"></div>
      <h2>MVP Leaderboard</h2>
      <div id="mvpboard"></div>
    </div>

    <div id="admin" class="tab hidden container">
      <h2>Admin Panel</h2>
      <button id="startBtn" onclick="startMatch()">Start Match</button>
      <button id="endBtn" onclick="endMatch()" disabled>End Match</button>
      <div id="resolveBets"></div>
    </div>
  </div>

<script>
let users = JSON.parse(localStorage.getItem('users')||'{}');
let currentUser = null;
let matchActive = false;
let bets = [];
let votes = {};
const roster = ["Erick","Yansy","Bernie","Erubial","Samir","Angel","Abel","Estress","Alan","Ace"];

function save() { localStorage.setItem('users', JSON.stringify(users)); }
function updateHeader() {
  if(!currentUser) return;
  let u=users[currentUser];
  document.getElementById('userStatus').innerText =
   `${currentUser} | ðŸ’°Total: ${u.total} | ðŸ’¸Avail: ${u.avail}`;
}
function login() {
  let u=document.getElementById('loginUser').value.trim();
  let p=document.getElementById('loginPass').value;
  if(u==="admin" && p==="edgebook2025"){ currentUser="admin"; }
  else if(users[u] && users[u].pass===p){ currentUser=u; }
  else { alert("Invalid login"); return; }
  document.getElementById('authSection').classList.add('hidden');
  document.getElementById('appSection').classList.remove('hidden');
  if(currentUser==="admin") document.getElementById('adminTab').classList.remove('hidden');
  else document.getElementById('adminTab').classList.add('hidden');
  updateHeader(); showTab('leader'); refreshBoards();
}
function createAccount() {
  let u=document.getElementById('newUser').value.trim();
  let p=document.getElementById('newPass').value;
  if(users[u]){alert("User exists");return;}
  users[u]={pass:p,total:100,avail:0,mvp:0}; save(); alert("Account created!");
}
function logout(){
  currentUser=null; document.getElementById('authSection').classList.remove('hidden');
  document.getElementById('appSection').classList.add('hidden');
}
function showTab(id){
  document.querySelectorAll('.tab').forEach(t=>t.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}
function startMatch(){
  if(matchActive){return;}
  matchActive=true;
  document.getElementById('startBtn').disabled=true;
  document.getElementById('endBtn').disabled=false;
  bets=[]; votes={};
  for(let u in users){
    users[u].avail=10;
    users[u].total-=10;
  }
  save(); updateHeader(); setupBetOptions(); setupMVPOptions();
}
function setupBetOptions(){
  let div=document.getElementById('betOptions');
  div.innerHTML="";
  roster.forEach(player=>{
    let odds=Math.floor(Math.random()*4)+1;
    let color= odds===1?"green":odds===2?"yellow":odds===3?"orange":"red";
    div.innerHTML+=`<div class="odds ${color}">${player} to score (x${odds})
    <button onclick="placeBet('${player}',${odds})">Bet</button></div>`;
  });
}
function placeBet(player,odds){
  if(!matchActive){alert("Match not active");return;}
  let u=users[currentUser];
  if(u.avail<=0){alert("No available coins");return;}
  u.avail--; bets.push({user:currentUser,player,odds}); save(); updateHeader();
}
function setupMVPOptions(){
  let s1=document.getElementById('mvp1'), s2=document.getElementById('mvp2'), s3=document.getElementById('mvp3');
  [s1,s2,s3].forEach(s=>{s.innerHTML=roster.map(r=>`<option>${r}</option>`).join("");});
  document.getElementById('mvpThanks').innerHTML="";
}
function submitMVP(){
  if(!matchActive){alert("Match not active");return;}
  if(votes[currentUser]){alert("Already voted");return;}
  let p1=document.getElementById('mvp1').value;
  let p2=document.getElementById('mvp2').value;
  let p3=document.getElementById('mvp3').value;
  if(p1===p2||p1===p3||p2===p3){alert("Cannot pick same player twice");return;}
  votes[currentUser]=[p1,p2,p3];
  document.getElementById('mvpThanks').innerText="Thanks for voting!";
}
function endMatch(){
  if(!matchActive)return;
  matchActive=false;
  document.getElementById('startBtn').disabled=false;
  document.getElementById('endBtn').disabled=true;
  let div=document.getElementById('resolveBets'); div.innerHTML="";
  bets.forEach((b,i)=>{
    div.innerHTML+=`<div>${b.user} bet on ${b.player} (x${b.odds})
    <button onclick="resolveBet(${i},true)">Hit</button>
    <button onclick="resolveBet(${i},false)">Miss</button></div>`;
  });
  // Apply MVP points
  for(let u in votes){
    let [a,b,c]=votes[u];
    if(users[a])users[a].mvp+=5;
    if(users[b])users[b].mvp+=3;
    if(users[c])users[c].mvp+=2;
  }
  save(); refreshBoards();
}
function resolveBet(idx,hit){
  let b=bets[idx]; if(!b)return;
  if(hit){ users[b.user].total += b.odds; }
  save(); refreshBoards(); updateHeader();
}
function refreshBoards(){
  let l=Object.entries(users).sort((a,b)=>b[1].total-a[1].total);
  document.getElementById('leaderboard').innerHTML=l.map(([u,d])=>`${u}: ${d.total}`).join("<br>");
  let m=Object.entries(users).sort((a,b)=>b[1].mvp-a[1].mvp);
  document.getElementById('mvpboard').innerHTML=m.map(([u,d])=>`${u}: ${d.mvp}`).join("<br>");
}
</script>
</body>
</html>
